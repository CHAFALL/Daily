# 웹 서버, 게임 서버 (유니티)

## 잡다한 것

- 포톤?? - 채팅 서버 같은거 포톤으로 만들면 쉽다는디?? 
  
  - 근데 직접 만들어봐야.. 의존 No! 기술적 진보 x

- 보통 게임 회사에서 웹 쪽은 Node.JS 비율이 더 많은 듯
  
  - 이상하게 스프링으로 잘 안함, (사내 관련된 것을 할 때는 많이 쓰는데 왤까??)
  
  - 애당초 웹 서버는 무거워도 크게 상관 x (컴퓨터 대수를 늘리면 되는 것이므로)

- 자바는 스프링, JS는 Node.JS 라면 C#은 asp.net이 있다.(한국에서 주류가 아님)

- Firebase같은 서버도 가능은 한데 비추 -> 직접 만들어서 하슈

- 서버를 구현해야 될 때 복잡해지는 것
  
  - 데이터 세이브 파일만 왔다갔다 하는 용도면 나쁘지 않은데 아이템까지 적용이 되어가지고 랭킹까지 우리가 넣고 싶다면...
    
    - 이러면 얘가 거짓말을 하는 것까지 잡아내야됨.
  
  - 인증을 해줘야 됨
    
    - 클라이언트에서 먼저 구글 쪽 운영하는 서버에 가서 로그인을 해가지고 정보를 받아오고 토큰을 받아가지고 게임 서버에다가 건네줘야 됨
    
    - 그럼 게임 서버가 믿을 수 있는 사람인지 구글 서버로 가서 확인을 함
    
    - 맞다고 하면 들여보냄
    
    - 참고로 누군가가 강탈해서 그걸 가지고 자기 인 척을 한다면?? (중간 탈취)
      
      - HTTPS를 이용해서 통신을 한다면 애당초 암호화가 되어서 우리가 고려안해줘도 됨. 
  
  - 보통은 인증 서버랑 게임 서버랑 따로 둠. (ex. 자바랑 유니티??)
    
    - 그러면 클라에서 게임 서버로 정보를 보내거나 얻어오고 할텐데 인증은 또 어떻게 할 것이냐? (매번 인증 서버 들렸다가 게임 서버로 가긴 좀....)
      
      - 크게 2가지 방식이 있다.
        
        - 첫번째 방식으로 인증 서버와 게임서버 둘만 동시에 사용하는 빠른 레디스 같은 느낌의 그런 NOSQL에다가 루키스 라는 애 얘는 통과했어라고 여기 있는 정보를 얘네들이 서로 왔다 갔다 하면서 이거를 기반으로 통신하는 방식이 있다. (여기에 등록이 끝났으면 레디스 같은 거에다가 설정을 하면 얘가 언제까지 유효하다) - 이 방식 별로 안 좋아함 (귀찮음)
        
        - 두번째 방식은 JWT 방식
          
          - 인증 도장을 빵 찍어주는 느낌
          
          - 클라가 게임서버와 통신을 할 때 JWT 토큰을 보내줌 (인증 서버에서 인증을 받았어!)
          
          - 해시 암호화를 해서 보내주므로 탈취 문제 No
          
          - 해시 특징
            
            - 동일한 값에 대한 해시를 취했을 때는 동일한 값이 나옴이 보장이 되지만
            
            - 반대로 뒤의 값을 안다고 해서 원래 있던 값을 알 수는 없다.
            
            - 단방향
          
          - 클라쪽은 나쁜 넘이 있을 수 있지만 서버쪽은 믿을 수 있는 착한 사람들의 것들이라 (운영자가 게임서버랑 인증 서버를 다 다루니깐) **서버 끼리 해시 키를 공유!!!**
          
          - 게임 서버도 인증 해시 값이 아니라 인증 키를 알고 있어야 된다. (인증서버도 당연히) - 절대 탈취되면 안되고 둘이서만 공유

## 질문

- 데이터를 엑셀이나 뭔가로 만들어 가지고 이거를 로컬 데이터 시스템에다가 뭔가 저장을 함수를 이용해서 하고 있는데 그러면 내가 다른 머신에서 같은 계정으로 동일한 게임을 할 때 어떻게 받아서 하냐? -> 서버라는 개념이 있어야 한다.

- 채팅 같은거를 하고 싶은데 어떻게 해야 되는지 
  
  - 채팅 서버를 만들려면 웹 서버일까 게임 서버일까?
  
  - 일반적인 경우에서는 연결이 유지된 상태에서만 사실 되는게 맞다 (웹 소켓은 특이한 경우여서 그건 예외로 하고)
    
    - 왜냐하면 채팅이란 걸 생각해보면 웹이랑 일반서버의 가장 큰 차이는 연결 여부인데 우리가 채팅할 때는 제가 말을 하면 그게 실시간으로 거의 다 모두에게 보여야 된다.
    
    - 그러니까 웹 서버 기술이 아니라 이건 게임 서버 쪽에 가까움
    
    - 벌써 양쪽 기술이 약간 섞이네..

- 경매장 같은 경우는??
  
  - 누가 아이템을 사면 그게 실시간으로 보이나요??
    
    - 아니죠? 그러면 경매장은 웹기반으로 만들어졌구나를 예상 가능.
    
    - 웹 기반으로 만들었다는 건 실시간으로 뭔가 이어지지 않고 대신 내가 뭔가 요청을 했을 때 그게 실패할 수 있다. (누군가가 먼저 선점)
  
  - 즉 실시간 통신이 필요하면 일반 서버(게임 서버)라고 보면 된다.
  
  - 같은 서버 끼리만 거래를 할 수 있는 건지 아니면은 저기 멀리 다른 서버랑도 거래가 가능한지에 따라서 또 복잡해짐. (다른 서버군이랑도 되어야 한다면 무조건 웹으로 갈 수 밖에 없다.)
    
    - 왜냐하면 일반서버라면 나에 대한 정보만 알고 있기 때문에 다른 이에 대한 정보를 다 동시에 관리할 수가 없기 때문에

- 요즘에는 채팅이라거나 이런 플랫폼 기반 약간 공통적인 기술은 다 웹으로 빼는 경우가 더 많은 것 같다. 
  
  - 채팅을 웹으로도 가능이 하고 경매도 일반으로 가능함....

- 매치메이킹 서버는?
  
  - 롤 같은 경우 대기열 같은 것
  
  - 실시간으로 할 듯. (1초마다 되었냐라고 물어보기 보단 연결을 유지하는 채로 하는데 더 쉬우니깐.)

- 아이템 구매 관련 (BM)
  
  - BM이 크게 광고를 넣거나 아니면은 결제를 해가지고 아이템을 사거나 둘 중 하나
  
  - 광고를 보는 것은 크게 신경 쓸 것이 없다
  
  - 광고를 본 다음에 애드모비?건 자기들만의 서버가 있을텐데 얘네들만 왔다갔다 하면 되므로
  
  - 아이템 결제는 어떤 통신 방식으로?
  
  - 실시간 통신이 아닌 웹 통신
    
    - 게임 서버에서도 웹통신 기능을 넣어가지고 겸용으로 사용 가능
    
    - 아니면 결제 관련된 처리를 하는 웹 서버를 따로 둬가지고 한다거나 아니면 아까 그 인증 서버에서 결제까지 같이 체크를 한다거나 이렇게 만들면 됨.
  
  - 아이템 결제는 클라에서 구글스토어 쪽 서버에 접속을 해서 (결제하는 비용이나 이런거는 스토어에 등록을 해둠, 앱 출시시에 어떤 아이템은 얼마인지 다 세팅을 해줘야 됨) 결제를 함, 그다음에 구매 성공했다고 구매 관련 토큰(JWT)을 주면 그러면 그 토큰을 들고 어떤 아이템을 구매했다고 인증 관련 서버쪽에다가 보냄
  
  - 그러면 인증 관련 서버에서 보낸 것을 확인하려고 구글 쪽에다가 확인 요청을 보내고 체크
  
  - 토큰 맞다고 하면 진행  (확률 같은 거 돌려서 보내줌 (이건 게임 서버))
  
  - 다 하고 마지막에 구글쪽 서버에도 알려줘야 됨
  
  - 헷갈려서 못 쓰겠음...

## 웹 서버랑 게임 서버의 차이점

- 지속 여부
  
  - 연결을 계속 한 상태에서 진행이 되는지 여부
  
  - 게임 서버 
    
    - 연결을 하고 있다는 얘기는 내가 클라이언트인데 서버 쪽에다가 붙어있기 때문에 서버 쪽에서도 거꾸로 나한테 말을 걸 수 있다. (양방향)
    
    - 아이를 하나만 키워서 잘 키우자는 느낌이 강함
      
      - 이 서버 하나를 만들기가 엄청 빡셈
      
      - 이거 하나만 구축이 되면 5000명이 여기 안에서만 놈. (동접수 제한이 있음)
  
  - 웹 서버 
    
    - 한 번만 뭔가 데이터를 보냈다가 다시 한번 받고 끝 (단발성)
    
    - 웹 서버가 여러개로 스케일링이 되어가지고 DB도 막 여러개이고 이렇다.
    
    - 웹은 전 세계적으로 접근해가지고 동접자 제한 x

                
